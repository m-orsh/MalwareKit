// Config.
$api    = 'https://scan.metascan-online.com/v2/file';
$apikey = '58ce3f1051aa149c179aa4a4e6fa7dc3';
$file   = 'test.txt';

// Build headers array.
$headers = array(
    'apikey: '.$apikey,
    'filename: '.basename($file)
);

// Build options array.
$options = array(
    CURLOPT_URL     => $api,
    CURLOPT_HTTPHEADER  => $headers,
    CURLOPT_POST        => true,
    CURLOPT_POSTFIELDS  => file_get_contents($file),
    CURLOPT_RETURNTRANSFER  => true,
    CURLOPT_SSL_VERIFYPEER  => false
);

// Init & execute API call.
$ch = curl_init();
curl_setopt_array($ch, $options);
$response = json_decode(curl_exec($ch), true);

echo $response;