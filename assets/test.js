var resultURL;

function startUpload(){

	var fileInput = document.getElementById("fileInput");

	var xhr = new XMLHttpRequest();

	xhr.upload.onprogress = function(e) {
        var percentComplete = (e.loaded / e.total) * 100;
        progressBar.value = percentComplete;
    };
    progressBar.value = 0;
	xhr.open("POST", "https://scan.metascan-online.com/v2/file", false);
	xhr.setRequestHeader("apikey","58ce3f1051aa149c179aa4a4e6fa7dc3",false);
	xhr.setRequestHeader("filename","blap",false);
	xhr.send(fileInput.files[0]);

	console.log("Upload response: " + xhr.responseText);

	var result = JSON.parse(xhr.responseText);
	var resultURL = "https://scan.metascan-online.com/v2/file/"+result.data_id;	

	xhr.open("GET", resultURL, false);
	xhr.setRequestHeader("apikey","58ce3f1051aa149c179aa4a4e6fa7dc3",false);
	xhr.send();

	console.log("Scan result: " + xhr.responseText);

	/*jQuery.ajax( {
	    url: 'https://scan.metascan-online.com/v2/file',
	    type: 'POST',
	    data: { content: 'testing test' },
	    beforeSend : function( xhr ) {
	        xhr.setRequestHeader( "Authorization", "BEARER " + access_token );
	    },
	    success: function( response ) {
	        // response
	        console.log('gtfo');
	    }
	} );*/

}

function getResult(){
	var xhr2 = new XMLHttpRequest();

	xhr2.open("GET", resultURL, false);
	xhr2.setRequestHeader("apikey","58ce3f1051aa149c179aa4a4e6fa7dc3",false);
	xhr2.send();

	console.log("Scan result: " + xhr2.responseText);
}